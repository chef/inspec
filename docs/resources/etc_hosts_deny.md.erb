---
title: About the etc_hosts_deny Resource
---

# etc_hosts_deny

Use the `etc_hosts_deny` InSpec audit resource to test rules set to reject daemon and client traffic set in /etc/hosts.deny.
## Syntax

An etc/hosts.deny rule specifies one or more daemons mapped to one or more clients,
with zero or more options to use to reject traffic when found.

## Syntax

Use the where clause to match a property to one or more rules in the hosts.deny file.

    describe etc_hosts_deny.where { property == ['values'] } do
      its ('client_list') { should eq [['values']] }
      its ('options') { should eq [['values']] }
    end

Use the optional constructor parameter to give an alternative path to hosts.deny

    describe etc_hosts_deny(hosts_path).where { property == ['values'] } do
      its ('client_list.flatten') { should eq [['values']] }
      its ('options.flatten') { should eq [['values']] }
    end

where

* `daemon_list` is a list of daemons that will be rejected to pass traffic in.
* `client_list` is a list of clients will be rejected to pass traffic in.
* `options` is a list of tasks that to be done with the rule when traffic is found.

## Supported Properties

    daemon_list', 'client_list', 'options'

## Property Examples and Return Types

### daemon_list([String])

`daemon_list` returns a 2d array of strings that matches the where condition of the filter table.

    describe etc_hosts_deny.where { client_list == ['127.0.1.154',  '[:fff:fAb0::]'] } do
      its('daemon_list') { should eq [['UNKNOWN', 'sshd']] }
    end

### client_list([String])

`client_list` returns a 2d array of strings that matches the where condition of the filter table.

    describe etc_hosts_deny.where { daemon_list == ['UNKNOWN', 'sshd'] } do
      its('client_list') { should eq [['192.168.0.0/16', '[abcd::0000:1234]']] }
    end

### options([String])

`options` returns a 2d array of strings that matches the where condition of the filter table.

    describe etc_hosts_deny.where { daemon_list == ['UNKNOWN', 'sshd'] } do
      its('options') { should eq [['deny', 'echo "REJECTED"']] }
    end
